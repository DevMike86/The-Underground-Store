<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Nexus | Underground Store</title>
    <style>
        :root { --blue: #8ab4f8; --dark: #000; --card: #1c1c1e; --green: #00e676; }
        body { background: var(--dark); color: #e8eaed; font-family: 'Courier New', monospace; margin: 0; display: flex; height: 100vh; overflow: hidden; }

        /* SIDEBAR CHAT */
        #terminal { width: 450px; background: #000; border-right: 1px solid #333; display: flex; flex-direction: column; padding: 20px; box-sizing: border-box; }
        #log { flex-grow: 1; overflow-y: auto; font-size: 14px; margin-bottom: 15px; border-bottom: 1px solid #222; padding-bottom: 10px; }
        .bot { color: var(--blue); margin-bottom: 15px; border-left: 2px solid var(--blue); padding-left: 10px; }
        .user { color: #fff; margin-bottom: 15px; text-align: right; }
        
        textarea { width: 100%; background: #0a0a0a; border: 1px solid #444; color: #fff; padding: 12px; border-radius: 8px; resize: none; height: 70px; outline: none; margin-bottom: 10px; }
        .btn-row { display: flex; gap: 10px; }
        .send-btn { flex: 2; background: var(--blue); color: #000; border: none; padding: 12px; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .clear-btn { flex: 1; background: #333; color: #fff; border: none; border-radius: 8px; cursor: pointer; }

        /* STORE SIDE */
        #store { flex: 1; padding: 40px; overflow-y: auto; }
        .app-card { background: var(--card); border: 1px solid #333; padding: 30px; border-radius: 15px; max-width: 600px; }
        
        /* PULSING DOWNLOAD BUTTON */
        .dl-btn { 
            display: block; 
            background: var(--green); 
            color: #000; 
            text-align: center; 
            padding: 18px; 
            border-radius: 8px; 
            text-decoration: none; 
            font-weight: bold; 
            margin: 20px 0; 
            border: none;
            width: 100%;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(0, 230, 118, 0.2);
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0px rgba(0, 230, 118, 0.4); }
            70% { box-shadow: 0 0 0 15px rgba(0, 230, 118, 0); }
            100% { box-shadow: 0 0 0 0px rgba(0, 230, 118, 0); }
        }

        .stars { font-size: 30px; margin: 15px 0; color: #333; cursor: pointer; }
        .star.gold { color: #fbbc04; }
    </style>
</head>
<body>

    <div id="terminal">
        <div style="color:var(--blue); font-weight:bold; margin-bottom:20px;">> DOLPHIN_LOCAL_NODE: ONLINE</div>
        <div id="log">
            <div class="bot"><b>AI:</b> Link established. Enter a command to begin.</div>
        </div>
        <textarea id="input" placeholder="Enter message..." onkeydown="checkKey(event)"></textarea>
        <div class="btn-row">
            <button class="send-btn" onclick="send()">EXECUTE (Enter)</button>
            <button class="clear-btn" onclick="clearLogs()">CLEAR</button>
        </div>
    </div>

    <div id="store">
        <div class="app-card">
            <h1>Nexus VPN <span style="font-size:14px; color:var(--blue);">v1.0</span></h1>
            <p>Uncensored APK build. Direct bypass for local restrictions.</p>
            
            <button class="dl-btn" onclick="downloadAPK()">DOWNLOAD APK (5.52 MB)</button>
            
            <div class="stars" id="stars">
                <span onclick="rate(1)">★</span><span onclick="rate(2)">★</span><span onclick="rate(3)">★</span><span onclick="rate(4)">★</span><span onclick="rate(5)">★</span>
            </div>
            
            <div id="comments"></div>
            <input type="text" id="comm" style="width:100%; padding:10px; background:#000; border:1px solid #333; color:#fff; margin-top:10px;" placeholder="Post review...">
            <button class="send-btn" style="margin-top:10px; width:120px;" onclick="post()">POST</button>
        </div>
    </div>

<script>
    const TUNNEL = "https://unadept-elocutionary-ling.ngrok-free.dev";
    const APK_URL = "https://raw.githubusercontent.com/DevMike86/The-Underground-Store/main/VERIFIED_NexusVPN.apk";

    // FORCED DOWNLOAD FUNCTION
    function downloadAPK() {
        const link = document.createElement('a');
        link.href = APK_URL;
        link.download = 'NexusVPN.apk'; // Forces the filename
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        addLog('AI', 'Download sequence initiated. Check your notification bar.');
    }

    function checkKey(e) { if(e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); send(); } }

    function addLog(who, msg) {
        const l = document.getElementById('log');
        l.innerHTML += `<div class="${who==='AI'?'bot':'user'}"><b>${who}:</b> ${msg}</div>`;
        l.scrollTop = l.scrollHeight;
    }

    async function send() {
        const i = document.getElementById('input');
        const val = i.value.trim();
        if(!val) return;
        addLog('You', val);
        i.value = "";
        try {
            const res = await fetch(`${TUNNEL}/v1/chat/completions`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'ngrok-skip-browser-warning': 'true' },
                body: JSON.stringify({
                    model: "local-model",
                    messages: [{role: "user", content: val}],
                    temperature: 0.8
                })
            });
            const data = await res.json();
            addLog('AI', data.choices[0].message.content);
        } catch (e) {
            addLog('AI', 'Error: Connection lost. Ensure LM Studio is active.');
        }
    }

    function clearLogs() { document.getElementById('log').innerHTML = '<div class="bot"><b>AI:</b> Logs wiped.</div>'; }
    
    function rate(n) {
        const s = document.getElementById('stars').children;
        for(let i=0; i<5; i++) s[i].style.color = (i < n) ? '#fbbc04' : '#333';
        addLog('AI', `User submitted ${n}-star rating.`);
    }

    function post() {
        const c = document.getElementById('comm');
        if(!c.value) return;
        document.getElementById('comments').innerHTML += `<div style="padding:10px; border-left:2px solid var(--blue); margin-top:10px;"><b>DevMike86:</b> ${c.value}</div>`;
        c.value = "";
    }
</script>
</body>
</html>
